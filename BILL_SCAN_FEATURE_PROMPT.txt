FEATURE: Scan Bill Photo to Add Items
======================================

PROJECT CONTEXT
---------------
- React Native 0.81.5, Expo SDK 54 (bare workflow), Android only
- Expo Image Picker is already a dependency (install with: npx expo install expo-image-picker)
- The file to modify is: screens/tabs/ItemsTab.js
- The "Add Item" button lives inside the ListFooterComponent of a FlatList
- The app uses a consistent accent color constant: ACCENT (imported from context/ThemeContext)
- All text uses Ysabeau font family (Ysabeau-Regular, Ysabeau-SemiBold, Ysabeau-Bold)
- Theme colors come from useTheme() hook: theme.surface, theme.background, theme.textPrimary,
  theme.textSecondary, theme.surfaceVariant, theme.outline, theme.outlineVariant, theme.onPrimary
- Ionicons is already available via @expo/vector-icons

IMPORTANT — NATIVE OCR PACKAGE
--------------------------------
Install ONLY: react-native-text-recognition (npm install react-native-text-recognition)
  - Version 1.0.2
  - Uses Google ML Kit on Android (no internet required, fully on-device)
  - API: TextRecognition.recognize(imageUri) => Promise<string[]>  (returns array of lines)
  - Its android/build.gradle uses old SDK defaults (compileSdkVersion 29).
    Override this by adding to android/build.gradle (root) inside the allprojects > ext block:
      ext {
        TextRecognition_compileSdkVersion = 35
        TextRecognition_buildToolsVersion = "35.0.0"
        TextRecognition_minSdkVersion = 24
        TextRecognition_targetSdkVersion = 35
      }

ANDROID PERMISSIONS
--------------------
Add to android/app/src/main/AndroidManifest.xml:
  <uses-permission android:name="android.permission.CAMERA"/>
(READ_EXTERNAL_STORAGE and WRITE_EXTERNAL_STORAGE are already present)

GRADLE / JDK NOTE
------------------
If the build fails with: Error resolving plugin [id: 'com.facebook.react.settings'] > 25.0.1
This means Gradle is running on JDK 25 which breaks Kotlin DSL script compilation.
Fix: add this line to android/gradle.properties:
  org.gradle.java.home=C:\\Program Files\\Java\\jdk-17
(or whichever JDK 17/21 path is installed on the machine)


FEATURE DESCRIPTION
--------------------
Add a small square button next to the existing "Add Item" button in ItemsTab.js.

1. SCAN BUTTON
   - Sits to the RIGHT of the "Add Item" dashed button
   - Same height as "Add Item", fixed square width (~60px)
   - Same style: dashed border, 2px, border color = ACCENT, background = theme.surface, borderRadius 16
   - Icon: <Ionicons name="receipt-outline" size={22} color={A} />
   - Tapping opens an action sheet (see #2)

2. ACTION SHEET (bottom sheet modal)
   - Slides up from the bottom, transparent overlay behind it
   - Tap outside dismisses it
   - Contents:
       - A small drag handle bar at the top (centered, 40x4, borderRadius 2)
       - Title: "Scan Bill" (Ysabeau-Bold, 17px, centered)
       - Option 1: camera-outline icon + "Take Photo" text
       - Option 2: images-outline icon + "Choose from Library" text
   - Tapping an option calls handlePickImage('camera') or handlePickImage('library')

3. IMAGE PICKING (handlePickImage function)
   - source = 'camera': call ImagePicker.requestCameraPermissionsAsync(), then launchCameraAsync()
   - source = 'library': call ImagePicker.requestMediaLibraryPermissionsAsync(), then launchImageLibraryAsync()
   - Both: mediaTypes: ['images'], quality: 0.9
   - If permission denied: Alert.alert('Permission needed', '...')
   - If user cancels picker: return early
   - While processing: show a full-screen translucent overlay Modal with ActivityIndicator + "Reading bill…" text
   - On success: call parseBillText(lines.join('\n'))
   - If parseBillText returns empty array: Alert.alert('No items found', 'Could not detect any items...')
   - If items found: setScannedItems(parsed) and setReviewModalVisible(true)

4. BILL TEXT PARSER (parseBillText function) — pure JS, no internet
   - Input: full OCR text as a single string (lines joined with \n)
   - Split into lines, skip empty lines and lines shorter than 3 chars
   - Skip lines matching this regex (case-insensitive):
       /subtotal|sub.?total|grand.?total|total|tax|vat|gst|discount|service charge|gratuity|tip|balance due|change|cash|credit|debit|thank you|order|table|receipt|invoice|phone|tel\.|address|website|www\.|http|visa|mastercard|amex|card no/i
   - For each remaining line, look for a price at the END of the line:
       regex: /(?:[$€£¥]?\s*)(\d{1,4}[.,]\d{2})\s*$/
   - If no price found: skip the line
   - Parse the price: parseFloat(priceMatch[1].replace(',', '.'))
   - Skip if price <= 0 or price > 999
   - Extract the name: everything before the price match index, then:
       - Strip leading quantity prefix: /^[\d]+\s*[x×.)\-]\s*/i
       - Strip bullet chars: /[*•·]+/g
       - Trim whitespace
   - Skip if name is empty or shorter than 2 chars
   - Return array of objects: { id: `scan_${Date.now()}_${index}`, name, price: price.toFixed(2), selected: true }

5. REVIEW MODAL (full-screen, animationType="slide", transparent=false)
   - Header section:
       - Title: "Review Scanned Items" (Ysabeau-Bold, 24px)
       - Subtitle: "Deselect or edit items before adding them" (Ysabeau-Regular, 14px, theme.textSecondary)
       - Bottom border divider
   - Body: FlatList of scanned items, each rendered as a ReviewItemRow (see #6)
   - Footer (fixed at bottom, bordered top, theme.surface background):
       - "Cancel" button (left, theme.surfaceVariant bg) — closes modal, clears scannedItems
       - "Add Selected (N)" button (right, ACCENT bg) — calls addScannedItems(), N = count of selected items

6. REVIEW ITEM ROW component (defined outside the main component for performance)
   Props: { item, accent, theme, onToggle, onNameChange, onPriceChange, onDelete }
   Layout (horizontal row):
     [checkbox toggle] [name TextInput, flex:1] [price TextInput, width:72] [trash icon button]
   - Checkbox: 26x26 square, borderRadius 7, borderWidth 2, borderColor = accent
     - When selected: filled with accent color, shows <Ionicons name="checkmark" size={13} color={onPrimary} />
     - When deselected: transparent fill
   - Name input: Ysabeau-Regular 15px, borderWidth 1, borderRadius 10, paddingH 10
   - Price input: width 72, textAlign right, same font/style as name input
   - Delete button: 36x36, shows <Ionicons name="trash-outline" size={18} color="#BA1A1A" />
   - Whole row: padding 10, marginH 8, marginV 4, borderRadius 14, backgroundColor theme.surface

7. addScannedItems function
   - Filter scannedItems where: selected === true AND name.trim() is not empty AND !isNaN(parseFloat(price))
   - If nothing selected: Alert.alert('No items selected', '...')
   - Map to final items: { id: `${Date.now()}_${index}`, name: i.name.trim(), price: parseFloat(i.price).toFixed(2) }
   - Append to existing items via setItems(prev => [...prev, ...newItems])
   - Close review modal and clear scannedItems

STATE VARIABLES TO ADD
-----------------------
  const [actionSheetVisible, setActionSheetVisible] = useState(false);
  const [reviewModalVisible, setReviewModalVisible] = useState(false);
  const [scannedItems, setScannedItems] = useState([]);
  const [isProcessing, setIsProcessing] = useState(false);

IMPORTS TO ADD
--------------
  import { ActivityIndicator, Alert } from 'react-native';   // add to existing RN import block
  import { Ionicons } from '@expo/vector-icons';
  import * as ImagePicker from 'expo-image-picker';
  import TextRecognition from 'react-native-text-recognition';
